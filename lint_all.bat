chcp 65001 >nul
@echo off
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ç–∏–ª—è –∫–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç...

for /d %%d in (lab_*) do (
    if exist "%%d" (
        echo üìÅ –ü—Ä–æ–≤–µ—Ä—è–µ–º %%d...
        
        echo   üé® –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...
        for /r "%%d" %%f in (*.cpp *.hpp *.h) do (
            clang-format --dry-run --Werror "%%f" >nul 2>&1
            if errorlevel 1 (
                echo     ‚ùå %%f - –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
            ) else (
                echo     ‚úÖ %%f - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ OK
            )
        )
        
        echo   üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞...
        for /r "%%d" %%f in (*.cpp *.hpp *.h) do (
            if exist "%%d\include" (
                clang-tidy "%%f" -- -std=c++17 -I%%d\include >nul 2>&1
            ) else (
                clang-tidy "%%f" -- -std=c++17 >nul 2>&1
            )
            if errorlevel 1 (
                echo     ‚ö†Ô∏è  %%f - –µ—Å—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —Å—Ç–∏–ª—è
            ) else (
                echo     ‚úÖ %%f - —Å—Ç–∏–ª—å OK
            )
        )
        
        echo   ‚úÖ %%d –ø—Ä–æ–≤–µ—Ä–µ–Ω
        echo.
    )
)

echo üéâ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
pause
